# Python for Pentesters
Link: https://tryhackme.com/room/pythonforcybersecurity
SEE THE RAW for Answers but Try Yourself hard.
## Sub Domain Enum
[SubDomainEnumPython](subdomainenum.py) </br>
[Wordlist](wordlist2.txt) <br> 
What other protocol could be used for subdomain enumeration?
<!-- dns -->
What function does Python use to get the input from the command line?
<!-- sys.argv -->

## Directory Enumeration
[DirectoryEnumPython](directoryenum.py) </br>
```
┌──(kali㉿kali)-[~]
└─$ python direnum.py 10.10.112.111
Valid directory: http://10.10.112.111/surfer.html
Valid directory: http://10.10.112.111/private.html
Valid directory: http://10.10.112.111/apollo.html
Valid directory: http://10.10.112.111/index.html
```
```
How many directories can your script identify on the target system? (extensions are .html)
What is the location of the login page?
Where did you find a cryptic hash?
Where are the usernames located?
What is the password assigned to Rabbit?
```

<!-- How many directories can your script identify on the target system? (extensions are .html) 4
What is the location of the login page?
private.html
Where did you find a cryptic hash?
apollo.html
Where are the usernames located?
surfer.html
What is the password assigned to Rabbit?
LOUSYRABBO   -->

## Network Scanner
```
What module was used to create the ARP request packets?
Which variable would you need to change according to your local IP block?
What variable would you change to run this code on a system with the network interface named ens33?
```
<!-- 
What module was used to create the ARP request packets?
scapy
Which variable would you need to change according to your local IP block?
ip_range
What variable would you change to run this code on a system with the network interface named ens33?
interface
 -->

## Port Scanner
[Python Port Scanner](portscanner.py)
```
What protocol will most likely be using TCP port 22?
What module did we import to be able to use sockets?
What function is likely to fail if we didn't import sys?
How many ports are open on the target machine?
What is the highest port number open on the target system?
```
<!-- 
What protocol will most likely be using TCP port 22?
ssh
What module did we import to be able to use sockets?
socket
What function is likely to fail if we didn't import sys?
sys.stdout.flush
How many ports are open on the target machine?
3
What is the highest port number open on the target system?
2100
-->


## File Downloader
```
import requests
url = 'https://assets.tryhackme.com/img/THMlogo.png'
r = requests.get(url, allow_redirects=True)
open('THMlogo.png', 'wb').write(r.content)
```
```
What is the function used to connect to the target website?
What step of the Unified Cyber Kill Chain can PSexec be used in?
```
<!--
What is the function used to connect to the target website?
requests.get()
What step of the Unified Cyber Kill Chain can PSexec be used in?
lateral movement
-->


## Hash Cracker
[Python Hash cracker](hash.py)
```
┌──(kali㉿kali)-[~/…/hack/thm/TryHackMe/PythonForPentesters]
└─$ python
Python 3.10.5 (main, Jun  8 2022, 09:26:22) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import hashlib
>>> hashlib.algorithms_available
{'shake_128', 'sha3_512', 'sha1', 'sha512_224', 'md4', 'sha3_384', 'sha512_256', 'md5-sha1', 'sha384', 'ripemd160', 'sha3_256', 'whirlpool', 'sha512', 'sha3_224', 'sm3', 'sha256', 'sha224', 'blake2b', 'shake_256', 'md5', 'blake2s'}
>>> 
```

┌──(kali㉿kali)-[~/…/hack/thm/TryHackMe/PythonForPentesters]
└─$ python hash.py                 
 ____                        _    _      
|  _ \  ___  ___ _ __   __ _| | _( )___  
| | | |/ _ \/ _ \ '_ \ / _` | |/ /// __| 
| |_| |  __/  __/ |_) | (_| |   <  \__ \ 
|____/ \___|\___| .__/ \__,_|_|\_\ |___/ 
                |_|                      
  ____        _   _                   _  _   
 |  _ \ _   _| |_| |__   ___  _ __   | || |  
 | |_) | | | | __| '_ \ / _ \| '_ \  | || |_ 
 |  __/| |_| | |_| | | | (_) | | | | |__   _|
 |_|    \__, |\__|_| |_|\___/|_| |_|    |_|  
        |___/                                
 ____            _            _                 
|  _ \ ___ _ __ | |_ ___  ___| |_ ___ _ __ ___  
| |_) / _ \ '_ \| __/ _ \/ __| __/ _ \ '__/ __| 
|  __/  __/ | | | ||  __/\__ \ ||  __/ |  \__ \ 
|_|   \___|_| |_|\__\___||___/\__\___|_|  |___/ 
                                                
  _   _    _    ____  _   _    ____ ____      _    ____ _  _______ ____  
 | | | |  / \  / ___|| | | |  / ___|  _ \    / \  / ___| |/ / ____|  _ \ 
 | |_| | / _ \ \___ \| |_| | | |   | |_) |  / _ \| |   | ' /|  _| | |_) |
 |  _  |/ ___ \ ___) |  _  | | |___|  _ <  / ___ \ |___| . \| |___|  _ < 
 |_| |_/_/   \_\____/|_| |_|  \____|_| \_\/_/   \_\____|_|\_\_____|_| \_\
                                                                         
  __              __  __ ____    ____  
 / _| ___  _ __  |  \/  |  _ \  | ___| 
| |_ / _ \| '__| | |\/| | | | | |___ \ 
|  _| (_) | |    | |  | | |_| |  ___) |
|_|  \___/|_|    |_|  |_|____/  |____/ 
                                       

Enter wordlist file location: subdomains.txt
Enter hash to be cracked: cd13b6a6af66fb774faa589a9d18f906
Found cleartext password! SomethingHERE
<!-- rainbow -->

─$ python hashsha256.py
 ____                        _    _      
|  _ \  ___  ___ _ __   __ _| | _( )___  
| | | |/ _ \/ _ \ '_ \ / _` | |/ /// __| 
| |_| |  __/  __/ |_) | (_| |   <  \__ \ 
|____/ \___|\___| .__/ \__,_|_|\_\ |___/ 
                |_|                      
  ____        _   _                   _  _   
 |  _ \ _   _| |_| |__   ___  _ __   | || |  
 | |_) | | | | __| '_ \ / _ \| '_ \  | || |_ 
 |  __/| |_| | |_| | | | (_) | | | | |__   _|
 |_|    \__, |\__|_| |_|\___/|_| |_|    |_|  
        |___/                                
 ____            _            _                 
|  _ \ ___ _ __ | |_ ___  ___| |_ ___ _ __ ___  
| |_) / _ \ '_ \| __/ _ \/ __| __/ _ \ '__/ __| 
|  __/  __/ | | | ||  __/\__ \ ||  __/ |  \__ \ 
|_|   \___|_| |_|\__\___||___/\__\___|_|  |___/ 
                                                
  _   _    _    ____  _   _    ____ ____      _    ____ _  _______ ____  
 | | | |  / \  / ___|| | | |  / ___|  _ \    / \  / ___| |/ / ____|  _ \ 
 | |_| | / _ \ \___ \| |_| | | |   | |_) |  / _ \| |   | ' /|  _| | |_) |
 |  _  |/ ___ \ ___) |  _  | | |___|  _ <  / ___ \ |___| . \| |___|  _ < 
 |_| |_/_/   \_\____/|_| |_|  \____|_| \_\/_/   \_\____|_|\_\_____|_| \_\
                                                                         
  __              ____  _   _    _    ____  ____   __   
 / _| ___  _ __  / ___|| | | |  / \  |___ \| ___| / /_  
| |_ / _ \| '__| \___ \| |_| | / _ \   __) |___ \| '_ \ 
|  _| (_) | |     ___) |  _  |/ ___ \ / __/ ___) | (_) |
|_|  \___/|_|    |____/|_| |_/_/   \_\_____|____/ \___/ 
                                                        

Enter wordlist file location: subdomains.txt
Enter hash to be cracked: 5030c5bd002de8713fef5daebd597620f5e8bcea31c603dccdfcdf502a57cc60
Found cleartext password! SOMETHINGHERE
<!-- <-- redwings -->

## KeyLoggers
[KeylogPython](keylogger.py)
import keyboard
keys = keyboard.record(until ='ENTER')
keyboard.play(keys)

```
What package installer was used?
What line in this code would you change to stop the result from being printed on the screen?
```
<!-- <--
What package installer was used?
pip3
What line in this code would you change to stop the result from being printed on the screen?
keyboard.play(keys)
--> 

## SSH Brute Forcing
[SSH]()
```
What username starting with the letter "t" did you find earlier?
What is the SSH password of this user?
What is the content of the flag.txt file?
```


<!-- What username starting with the letter "t" did you find earlier?
tiffany
What is the SSH password of this user?
trustno1
What is the content of the flag.txt file?
THsome -->

